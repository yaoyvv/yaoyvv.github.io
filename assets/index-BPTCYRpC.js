import{d as J,i as ee,f as t,r as g,j as w,k as te,U as ae,V as se,q as d,c as _,o as c,a as o,p as n,b as I,K as u,v as r,t as l,u as e,W as ne,X as P,Y as k,e as y,Z as v,Q as le,g as oe}from"./index-DfAD_XQf.js";import{g as ie}from"./list-C1GqivMZ.js";import{T as A}from"./index-Dvk21AXA.js";const ce={class:"left-operation-container"},ue={key:0,class:"selected-count"},re={class:"search-input"},de={key:0},pe={key:1},ge={key:2},_e={key:0,class:"payment-col"},me={key:1,class:"payment-col"},fe="index",he=J({name:"ListBase",__name:"index",setup(ye){const K=ee(),U=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{title:t("pages.listBase.contractName"),align:"left",width:320,colKey:"name",fixed:"left"},{title:t("pages.listBase.contractStatus"),colKey:"status",width:160},{title:t("pages.listBase.contractNum"),width:160,ellipsis:!0,colKey:"no"},{title:t("pages.listBase.contractType"),width:160,ellipsis:!0,colKey:"contractType"},{title:t("pages.listBase.contractPayType"),width:160,ellipsis:!0,colKey:"paymentType"},{title:t("pages.listBase.contractAmount"),width:160,ellipsis:!0,colKey:"amount"},{title:t("pages.listBase.operation"),align:"left",fixed:"right",width:160,colKey:"op"}],f=g([]),T=g({defaultPageSize:20,total:100,defaultCurrent:1}),x=g(""),B=g(!1),V=async()=>{B.value=!0;try{const{list:s}=await ie();f.value=s,T.value={...T.value,total:s.length}}catch(s){console.log(s)}finally{B.value=!1}},m=g(-1),D=w(()=>{if(m.value>-1){const{name:s}=f.value[m.value];return`删除后，${s}的所有合同信息将被清空，且无法恢复`}return""});te(()=>{V()});const C=g(!1),p=g([1,2]),S=ae(),E=()=>{m.value=-1},M=()=>{f.value.splice(m.value,1),T.value.total=f.value.length;const s=p.value.indexOf(m.value);s>-1&&p.value.splice(s,1),C.value=!1,le.success("删除成功"),E()},R=()=>{E()},L=s=>{p.value=s},O=(s,i)=>{console.log("分页变化",s,i)},Y=(s,i)=>{console.log("统一Change",s,i)},$=()=>{S.push("/detail/base")},G=()=>{S.push("/form/base")},X=s=>{m.value=s.rowIndex,C.value=!0},j=w(()=>({offsetTop:K.isUseTabsRouter?48:0,container:`.${se}-layout`}));return(s,i)=>{const b=d("t-button"),z=d("t-input"),F=d("t-row"),h=d("t-tag"),N=d("t-link"),q=d("t-space"),H=d("t-table"),Q=d("t-card"),W=d("t-dialog");return c(),_("div",null,[o(Q,{class:"list-card-container",bordered:!1},{default:n(()=>[o(F,{justify:"space-between"},{default:n(()=>[I("div",ce,[o(b,{onClick:G},{default:n(()=>[r(l(e(t)("pages.listBase.create")),1)]),_:1}),o(b,{variant:"base",theme:"default",disabled:!p.value.length},{default:n(()=>[r(l(e(t)("pages.listBase.export")),1)]),_:1},8,["disabled"]),p.value.length?(c(),_("p",ue,l(e(t)("pages.listBase.select"))+" "+l(p.value.length)+" "+l(e(t)("pages.listBase.items")),1)):u("",!0)]),I("div",re,[o(z,{modelValue:x.value,"onUpdate:modelValue":i[0]||(i[0]=a=>x.value=a),placeholder:e(t)("pages.listBase.placeholder"),clearable:""},{"suffix-icon":n(()=>[o(e(ne),{size:"16px"})]),_:1},8,["modelValue","placeholder"])])]),_:1}),o(H,{data:f.value,columns:U,"row-key":fe,"vertical-align":"top",hover:!0,pagination:T.value,"selected-row-keys":p.value,loading:B.value,"header-affixed-top":j.value,onPageChange:O,onChange:Y,onSelectChange:i[2]||(i[2]=a=>L(a))},{status:n(({row:a})=>[a.status===e(v).FAIL?(c(),y(h,{key:0,theme:"danger",variant:"light"},{default:n(()=>[r(l(e(t)("pages.listBase.contractStatusEnum.fail")),1)]),_:1})):u("",!0),a.status===e(v).AUDIT_PENDING?(c(),y(h,{key:1,theme:"warning",variant:"light"},{default:n(()=>[r(l(e(t)("pages.listBase.contractStatusEnum.audit")),1)]),_:1})):u("",!0),a.status===e(v).EXEC_PENDING?(c(),y(h,{key:2,theme:"warning",variant:"light"},{default:n(()=>[r(l(e(t)("pages.listBase.contractStatusEnum.pending")),1)]),_:1})):u("",!0),a.status===e(v).EXECUTING?(c(),y(h,{key:3,theme:"success",variant:"light"},{default:n(()=>[r(l(e(t)("pages.listBase.contractStatusEnum.executing")),1)]),_:1})):u("",!0),a.status===e(v).FINISH?(c(),y(h,{key:4,theme:"success",variant:"light"},{default:n(()=>[r(l(e(t)("pages.listBase.contractStatusEnum.finish")),1)]),_:1})):u("",!0)]),contractType:n(({row:a})=>[a.contractType===e(k).MAIN?(c(),_("p",de,l(e(t)("pages.listBase.contractStatusEnum.fail")),1)):u("",!0),a.contractType===e(k).SUB?(c(),_("p",pe,l(e(t)("pages.listBase.contractStatusEnum.audit")),1)):u("",!0),a.contractType===e(k).SUPPLEMENT?(c(),_("p",ge,l(e(t)("pages.listBase.contractStatusEnum.pending")),1)):u("",!0)]),paymentType:n(({row:a})=>[a.paymentType===e(P).PAYMENT?(c(),_("div",_e,[r(l(e(t)("pages.listBase.pay")),1),o(A,{class:"dashboard-item-trend",type:"up"})])):u("",!0),a.paymentType===e(P).RECEIPT?(c(),_("div",me,[r(l(e(t)("pages.listBase.receive")),1),o(A,{class:"dashboard-item-trend",type:"down"})])):u("",!0)]),op:n(a=>[o(q,null,{default:n(()=>[o(N,{theme:"primary",onClick:i[1]||(i[1]=Z=>$())},{default:n(()=>[r(l(e(t)("pages.listBase.detail")),1)]),_:1}),o(N,{theme:"danger",onClick:Z=>X(a)},{default:n(()=>[r(l(e(t)("pages.listBase.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination","selected-row-keys","loading","header-affixed-top"])]),_:1}),o(W,{visible:C.value,"onUpdate:visible":i[3]||(i[3]=a=>C.value=a),header:"确认删除当前所选合同？",body:D.value,"on-cancel":R,onConfirm:M},null,8,["visible","body"])])}}}),Be=oe(he,[["__scopeId","data-v-c3c05ace"]]);export{Be as default};
